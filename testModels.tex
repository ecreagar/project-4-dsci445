% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{TestModels}
\author{}
\date{\vspace{-2.5em}}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={TestModels},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{puntinfo }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Data/puntinfo.csv"}\NormalTok{)}
\NormalTok{puntinfo}\SpecialCharTok{$}\NormalTok{hangTime[}\FunctionTok{is.na}\NormalTok{(puntinfo}\SpecialCharTok{$}\NormalTok{hangTime)] }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(puntinfo}\SpecialCharTok{$}\NormalTok{hangTime, }\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{colList }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"away\_player\_1"}\NormalTok{, }\StringTok{"away\_player\_2"}\NormalTok{, }\StringTok{"away\_player\_3"}\NormalTok{, }\StringTok{"away\_player\_4"}\NormalTok{, }\StringTok{"away\_player\_5"}\NormalTok{, }\StringTok{"away\_player\_6"}\NormalTok{, }\StringTok{"away\_player\_7"}\NormalTok{, }\StringTok{"away\_player\_8"}\NormalTok{, }\StringTok{"away\_player\_9"}\NormalTok{, }\StringTok{"away\_player\_10"}\NormalTok{, }\StringTok{"away\_player\_11"}\NormalTok{, }\StringTok{"home\_player\_1"}\NormalTok{, }\StringTok{"home\_player\_2"}\NormalTok{, }\StringTok{"home\_player\_3"}\NormalTok{, }\StringTok{"home\_player\_4"}\NormalTok{, }\StringTok{"home\_player\_5"}\NormalTok{, }\StringTok{"home\_player\_6"}\NormalTok{, }\StringTok{"home\_player\_7"}\NormalTok{, }\StringTok{"home\_player\_8"}\NormalTok{, }\StringTok{"home\_player\_9"}\NormalTok{, }\StringTok{"home\_player\_10"}\NormalTok{, }\StringTok{"home\_player\_11"}\NormalTok{)}

\NormalTok{calcDistance }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x1, y1, x2, y2)\{}
\NormalTok{  distance }\OtherTok{=} \FunctionTok{sqrt}\NormalTok{((x1}\SpecialCharTok{{-}}\NormalTok{x2)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ (y1}\SpecialCharTok{{-}}\NormalTok{y2)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(distance)}
\NormalTok{\}}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(colList))\{}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(puntinfo))\{}
\NormalTok{    tempSplit }\OtherTok{=} \FunctionTok{strsplit}\NormalTok{(puntinfo[j, colList[i]], }\StringTok{","}\NormalTok{)[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{    tempX }\OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{substring}\NormalTok{(tempSplit[}\DecValTok{1}\NormalTok{], }\DecValTok{2}\NormalTok{))}
\NormalTok{    tempY }\OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{substring}\NormalTok{(tempSplit[}\DecValTok{2}\NormalTok{], }\DecValTok{2}\NormalTok{,}\FunctionTok{nchar}\NormalTok{(tempSplit[}\DecValTok{2}\NormalTok{])}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}
\NormalTok{    catchX }\OtherTok{=}\NormalTok{ puntinfo[j, }\StringTok{"field\_position\_x"}\NormalTok{]}
\NormalTok{    catchY }\OtherTok{=}\NormalTok{ puntinfo[j, }\StringTok{"field\_position\_y"}\NormalTok{]}
\NormalTok{    puntinfo[j, colList[i]] }\OtherTok{=} \FunctionTok{calcDistance}\NormalTok{(tempX, tempY, catchX, catchY)}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{puntinfo[}\DecValTok{9}\SpecialCharTok{:}\DecValTok{30}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(puntinfo[}\DecValTok{9}\SpecialCharTok{:}\DecValTok{30}\NormalTok{], as.numeric)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{noPlayerList }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"hangTime"}\NormalTok{, }\StringTok{"playDirection"}\NormalTok{, }\StringTok{"punt\_position\_x"}\NormalTok{, }\StringTok{"punt\_position\_y"}\NormalTok{, }\StringTok{"field\_position\_x"}\NormalTok{, }\StringTok{"field\_position\_y"}\NormalTok{, }\StringTok{"yards\_gained"}\NormalTok{)}

\NormalTok{awayPlayerList }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"away\_player\_1"}\NormalTok{, }\StringTok{"away\_player\_2"}\NormalTok{, }\StringTok{"away\_player\_3"}\NormalTok{, }\StringTok{"away\_player\_4"}\NormalTok{, }\StringTok{"away\_player\_5"}\NormalTok{, }\StringTok{"away\_player\_6"}\NormalTok{, }\StringTok{"away\_player\_7"}\NormalTok{, }\StringTok{"away\_player\_8"}\NormalTok{, }\StringTok{"away\_player\_9"}\NormalTok{, }\StringTok{"away\_player\_10"}\NormalTok{, }\StringTok{"away\_player\_11"}\NormalTok{)}

\NormalTok{homePlayerList }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"home\_player\_1"}\NormalTok{, }\StringTok{"home\_player\_2"}\NormalTok{, }\StringTok{"home\_player\_3"}\NormalTok{, }\StringTok{"home\_player\_4"}\NormalTok{, }\StringTok{"home\_player\_5"}\NormalTok{, }\StringTok{"home\_player\_6"}\NormalTok{, }\StringTok{"home\_player\_7"}\NormalTok{, }\StringTok{"home\_player\_8"}\NormalTok{, }\StringTok{"home\_player\_9"}\NormalTok{, }\StringTok{"home\_player\_10"}\NormalTok{, }\StringTok{"home\_player\_11"}\NormalTok{)}

\NormalTok{colList2 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"receiving\_player\_1"}\NormalTok{, }\StringTok{"receiving\_player\_2"}\NormalTok{, }\StringTok{"receiving\_player\_3"}\NormalTok{, }\StringTok{"receiving\_player\_4"}\NormalTok{, }\StringTok{"receiving\_player\_5"}\NormalTok{, }\StringTok{"receiving\_player\_6"}\NormalTok{, }\StringTok{"receiving\_player\_7"}\NormalTok{, }\StringTok{"receiving\_player\_8"}\NormalTok{, }\StringTok{"receiving\_player\_9"}\NormalTok{, }\StringTok{"receiving\_player\_10"}\NormalTok{, }\StringTok{"receiving\_player\_11"}\NormalTok{, }\StringTok{"punting\_player\_1"}\NormalTok{, }\StringTok{"punting\_player\_2"}\NormalTok{, }\StringTok{"punting\_player\_3"}\NormalTok{, }\StringTok{"punting\_player\_4"}\NormalTok{, }\StringTok{"punting\_player\_5"}\NormalTok{, }\StringTok{"punting\_player\_6"}\NormalTok{, }\StringTok{"punting\_player\_7"}\NormalTok{, }\StringTok{"punting\_player\_8"}\NormalTok{, }\StringTok{"punting\_player\_9"}\NormalTok{, }\StringTok{"punting\_player\_10"}\NormalTok{, }\StringTok{"punting\_player\_11"}\NormalTok{)}

\NormalTok{noPlayerDF }\OtherTok{=}\NormalTok{ puntinfo[, (}\FunctionTok{names}\NormalTok{(puntinfo) }\SpecialCharTok{\%in\%}\NormalTok{ noPlayerList)]}
\NormalTok{awayPlayerDF }\OtherTok{=}\NormalTok{ puntinfo[, (}\FunctionTok{names}\NormalTok{(puntinfo) }\SpecialCharTok{\%in\%}\NormalTok{ awayPlayerList)]}
\NormalTok{homePlayerDF }\OtherTok{=}\NormalTok{ puntinfo[, (}\FunctionTok{names}\NormalTok{(puntinfo) }\SpecialCharTok{\%in\%}\NormalTok{ homePlayerList)]}

\NormalTok{playerSorted }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{ncol =} \DecValTok{22}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{0}\NormalTok{))}
\FunctionTok{colnames}\NormalTok{(playerSorted) }\OtherTok{=}\NormalTok{ colList2}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(awayPlayerDF))\{}
\NormalTok{  tempRowAway }\OtherTok{=} \FunctionTok{sort}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(awayPlayerDF[i,], }\AttributeTok{use.names =} \ConstantTok{FALSE}\NormalTok{))}
\NormalTok{  tempRowHome }\OtherTok{=} \FunctionTok{sort}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(homePlayerDF[i,], }\AttributeTok{use.names =} \ConstantTok{FALSE}\NormalTok{))}
\NormalTok{  minAway }\OtherTok{=} \FunctionTok{min}\NormalTok{(tempRowAway)}
\NormalTok{  minHome }\OtherTok{=} \FunctionTok{min}\NormalTok{(tempRowHome)}
  \ControlFlowTok{if}\NormalTok{(minAway}\SpecialCharTok{\textless{}}\NormalTok{minHome)\{}
\NormalTok{    tempRow }\OtherTok{=} \FunctionTok{append}\NormalTok{(tempRowAway, tempRowHome)}
\NormalTok{  \}}
  \ControlFlowTok{else}\NormalTok{\{}
\NormalTok{    tempRow }\OtherTok{=} \FunctionTok{append}\NormalTok{(tempRowHome, tempRowAway)}
\NormalTok{  \}}
  
\NormalTok{  playerSorted[}\FunctionTok{nrow}\NormalTok{(playerSorted)}\SpecialCharTok{+}\DecValTok{1}\NormalTok{,] }\OtherTok{=}\NormalTok{ tempRow}
\NormalTok{\}}

\NormalTok{puntSorted }\OtherTok{=} \FunctionTok{cbind}\NormalTok{(noPlayerDF, playerSorted)}
\CommentTok{\# Store gameIds and playIds for specific analysis}
\NormalTok{puntinfo }\OtherTok{=}\NormalTok{ puntSorted}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{drop }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"X"}\NormalTok{,}\StringTok{"gameId"}\NormalTok{, }\StringTok{"playId"}\NormalTok{, }\StringTok{"specialTeamsResult"}\NormalTok{ , }\StringTok{"tackle\_position\_x"}\NormalTok{, }\StringTok{"tackle\_position\_y"}\NormalTok{, }\StringTok{"playDirection"}\NormalTok{)}
\NormalTok{puntSorted}\OtherTok{\textless{}{-}}\NormalTok{ puntSorted[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(puntSorted) }\SpecialCharTok{\%in\%}\NormalTok{ drop)]}
\NormalTok{sample }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(puntSorted), }\FunctionTok{nrow}\NormalTok{(puntSorted) }\SpecialCharTok{*} \DecValTok{1413}\SpecialCharTok{/}\DecValTok{1766}\NormalTok{)}

\NormalTok{train }\OtherTok{\textless{}{-}}\NormalTok{ puntSorted[sample,]}
\NormalTok{test }\OtherTok{\textless{}{-}}\NormalTok{ puntSorted[}\SpecialCharTok{{-}}\NormalTok{sample,]}

\NormalTok{xtrain }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(}\FunctionTok{subset}\NormalTok{(train, }\AttributeTok{select=}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(yards\_gained)))}
\NormalTok{xtest }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(}\FunctionTok{subset}\NormalTok{(test, }\AttributeTok{select=}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(yards\_gained)))}
\NormalTok{ytrain }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(}\FunctionTok{subset}\NormalTok{(train, }\AttributeTok{select=}\FunctionTok{c}\NormalTok{(yards\_gained)))}
\NormalTok{ytest }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(}\FunctionTok{subset}\NormalTok{(test, }\AttributeTok{select=}\FunctionTok{c}\NormalTok{(yards\_gained)))}
\CommentTok{\# xtrain \textless{}{-} model.matrix(yards\_gained\textasciitilde{}., train)[,{-}1]}
\CommentTok{\# xtest \textless{}{-} model.matrix(yards\_gained\textasciitilde{}., test)[,{-}1]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Linear Regression}
\NormalTok{lmMod }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train)}

\FunctionTok{summary}\NormalTok{(lmMod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = yards_gained ~ ., data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.394  -4.360  -0.807   3.077  50.198 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(>|t|)    
## (Intercept)          2.536213   3.115170   0.814 0.415699    
## hangTime            -0.678110   0.464588  -1.460 0.144628    
## punt_position_x     -0.006202   0.009267  -0.669 0.503477    
## punt_position_y     -0.021898   0.075025  -0.292 0.770423    
## field_position_x    -0.004284   0.011605  -0.369 0.712090    
## field_position_y    -0.005419   0.017642  -0.307 0.758781    
## receiving_player_1  -0.566619   0.338538  -1.674 0.094411 .  
## receiving_player_2  -0.019239   0.084492  -0.228 0.819914    
## receiving_player_3  -0.165088   0.067111  -2.460 0.014019 *  
## receiving_player_4  -0.178601   0.069235  -2.580 0.009993 ** 
## receiving_player_5   0.203372   0.083388   2.439 0.014858 *  
## receiving_player_6  -0.202392   0.098151  -2.062 0.039390 *  
## receiving_player_7   0.073420   0.104774   0.701 0.483577    
## receiving_player_8  -0.048443   0.098528  -0.492 0.623035    
## receiving_player_9   0.075288   0.091124   0.826 0.408824    
## receiving_player_10 -0.085953   0.070997  -1.211 0.226231    
## receiving_player_11 -0.048275   0.046770  -1.032 0.302170    
## punting_player_1     0.274070   0.073512   3.728 0.000201 ***
## punting_player_2     0.240767   0.066559   3.617 0.000308 ***
## punting_player_3     0.146013   0.099749   1.464 0.143473    
## punting_player_4     0.063342   0.132203   0.479 0.631926    
## punting_player_5     0.002715   0.134122   0.020 0.983854    
## punting_player_6    -0.044797   0.136050  -0.329 0.742001    
## punting_player_7     0.038059   0.124586   0.305 0.760046    
## punting_player_8     0.058586   0.105723   0.554 0.579572    
## punting_player_9     0.141736   0.084420   1.679 0.093390 .  
## punting_player_10    0.096383   0.057064   1.689 0.091436 .  
## punting_player_11   -0.062376   0.046635  -1.338 0.181264    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 7.452 on 1385 degrees of freedom
## Multiple R-squared:  0.169,  Adjusted R-squared:  0.1528 
## F-statistic: 10.43 on 27 and 1385 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lmMod)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-5-1.pdf}
\includegraphics{testModels_files/figure-latex/unnamed-chunk-5-2.pdf}
\includegraphics{testModels_files/figure-latex/unnamed-chunk-5-3.pdf}
\includegraphics{testModels_files/figure-latex/unnamed-chunk-5-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lmMod, test)}

\NormalTok{predTable }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\AttributeTok{actuals=}\NormalTok{test}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{predicted=}\NormalTok{pred))}

\FunctionTok{ggplot}\NormalTok{(predTable, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actuals, }\AttributeTok{y =}\NormalTok{ predicted)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{\textquotesingle{}lm\textquotesingle{}}\NormalTok{, }\AttributeTok{formula =}\NormalTok{ y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x) }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-5-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lmMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Logistic Regression}
\NormalTok{logitModel }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(logitModel)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = yards_gained ~ ., data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -20.394   -4.360   -0.807    3.077   50.198  
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(>|t|)    
## (Intercept)          2.536213   3.115170   0.814 0.415699    
## hangTime            -0.678110   0.464588  -1.460 0.144628    
## punt_position_x     -0.006202   0.009267  -0.669 0.503477    
## punt_position_y     -0.021898   0.075025  -0.292 0.770423    
## field_position_x    -0.004284   0.011605  -0.369 0.712090    
## field_position_y    -0.005419   0.017642  -0.307 0.758781    
## receiving_player_1  -0.566619   0.338538  -1.674 0.094411 .  
## receiving_player_2  -0.019239   0.084492  -0.228 0.819914    
## receiving_player_3  -0.165088   0.067111  -2.460 0.014019 *  
## receiving_player_4  -0.178601   0.069235  -2.580 0.009993 ** 
## receiving_player_5   0.203372   0.083388   2.439 0.014858 *  
## receiving_player_6  -0.202392   0.098151  -2.062 0.039390 *  
## receiving_player_7   0.073420   0.104774   0.701 0.483577    
## receiving_player_8  -0.048443   0.098528  -0.492 0.623035    
## receiving_player_9   0.075288   0.091124   0.826 0.408824    
## receiving_player_10 -0.085953   0.070997  -1.211 0.226231    
## receiving_player_11 -0.048275   0.046770  -1.032 0.302170    
## punting_player_1     0.274070   0.073512   3.728 0.000201 ***
## punting_player_2     0.240767   0.066559   3.617 0.000308 ***
## punting_player_3     0.146013   0.099749   1.464 0.143473    
## punting_player_4     0.063342   0.132203   0.479 0.631926    
## punting_player_5     0.002715   0.134122   0.020 0.983854    
## punting_player_6    -0.044797   0.136050  -0.329 0.742001    
## punting_player_7     0.038059   0.124586   0.305 0.760046    
## punting_player_8     0.058586   0.105723   0.554 0.579572    
## punting_player_9     0.141736   0.084420   1.679 0.093390 .  
## punting_player_10    0.096383   0.057064   1.689 0.091436 .  
## punting_player_11   -0.062376   0.046635  -1.338 0.181264    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 55.53353)
## 
##     Null deviance: 92559  on 1412  degrees of freedom
## Residual deviance: 76914  on 1385  degrees of freedom
## AIC: 9715.6
## 
## Number of Fisher Scoring iterations: 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(logitModel, test)}
\NormalTok{logitMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Best subset selection}
\NormalTok{subsetMod }\OtherTok{\textless{}{-}} \FunctionTok{regsubsets}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ puntinfo[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(puntinfo) }\SpecialCharTok{\%in\%}\NormalTok{ drop)], }\AttributeTok{nvmax =} \DecValTok{20}\NormalTok{, }\AttributeTok{method =} \StringTok{"backward"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{), }\AttributeTok{y =} \FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)) }\SpecialCharTok{+} 
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{), }\AttributeTok{y =} \FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"AdjR2"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{"Size of Subset"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which.max}\NormalTok{(}\FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(subsetMod, }\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         (Intercept)            hangTime     punt_position_x    field_position_x 
##          2.52107918         -0.59759935         -0.01362638         -0.01261570 
##  receiving_player_1  receiving_player_3  receiving_player_4  receiving_player_5 
##         -0.87249602         -0.17392328         -0.17279397          0.20844085 
##  receiving_player_6 receiving_player_10 receiving_player_11    punting_player_1 
##         -0.11346631         -0.07929097         -0.04780802          0.28566260 
##    punting_player_2    punting_player_3    punting_player_7    punting_player_9 
##          0.22979705          0.12933741          0.12492652          0.07741438 
##   punting_player_10 
##          0.08943229
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(subsetMod, }\AttributeTok{scale =} \StringTok{"adjr2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-7-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subsetMod }\OtherTok{\textless{}{-}} \FunctionTok{regsubsets}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ puntinfo[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(puntinfo) }\SpecialCharTok{\%in\%}\NormalTok{ drop)], }\AttributeTok{nvmax =} \DecValTok{20}\NormalTok{, }\AttributeTok{method =} \StringTok{"forward"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{), }\AttributeTok{y =} \FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)) }\SpecialCharTok{+} 
    \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{20}\NormalTok{), }\AttributeTok{y =} \FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)) }\SpecialCharTok{+}
    \FunctionTok{ylab}\NormalTok{(}\StringTok{"AdjR2"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{"Size of Subset"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-7-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which.max}\NormalTok{(}\FunctionTok{summary}\NormalTok{(subsetMod)}\SpecialCharTok{$}\NormalTok{adjr2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(subsetMod, }\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         (Intercept)            hangTime     punt_position_x    field_position_x 
##          2.52107918         -0.59759935         -0.01362638         -0.01261570 
##  receiving_player_1  receiving_player_3  receiving_player_4  receiving_player_5 
##         -0.87249602         -0.17392328         -0.17279397          0.20844085 
##  receiving_player_6 receiving_player_10 receiving_player_11    punting_player_1 
##         -0.11346631         -0.07929097         -0.04780802          0.28566260 
##    punting_player_2    punting_player_3    punting_player_7    punting_player_9 
##          0.22979705          0.12933741          0.12492652          0.07741438 
##   punting_player_10 
##          0.08943229
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(subsetMod, }\AttributeTok{scale =} \StringTok{"adjr2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-7-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Lasso}
\NormalTok{lassoMod }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xtrain, }\AttributeTok{y =}\NormalTok{ train}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }\AttributeTok{nfolds =} \DecValTok{10}\NormalTok{)}

\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lassoMod, }\AttributeTok{s =}\NormalTok{ lassoMod}\SpecialCharTok{$}\NormalTok{lambda.min, }\AttributeTok{newx =}\NormalTok{ xtest)}

\NormalTok{predTable }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\AttributeTok{actuals=}\NormalTok{test}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{pred=}\NormalTok{pred))}

\FunctionTok{ggplot}\NormalTok{(predTable, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actuals, }\AttributeTok{y =}\NormalTok{ pred)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lassoMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ridge Regression}
\NormalTok{lambda }\OtherTok{\textless{}{-}} \DecValTok{10}\SpecialCharTok{\^{}}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{length.out =} \DecValTok{100}\NormalTok{)}
\NormalTok{ridgeMod }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xtrain, }\AttributeTok{y =}\NormalTok{ train}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{alpha =} \DecValTok{0}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ lambda)}
\NormalTok{ridgePred }\OtherTok{=} \FunctionTok{predict}\NormalTok{(ridgeMod, xtest, }\AttributeTok{s=}\NormalTok{ridgeMod}\SpecialCharTok{$}\NormalTok{lambda.min)}

\NormalTok{predTable }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\AttributeTok{actuals=}\NormalTok{test}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{pred=}\NormalTok{ridgePred))}

\FunctionTok{ggplot}\NormalTok{(predTable, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actuals, }\AttributeTok{y =}\NormalTok{ pred)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}blue\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ridgeMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((ridgePred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# GAMs}
\NormalTok{gamMod }\OtherTok{\textless{}{-}} \FunctionTok{gam}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(gamMod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call: gam(formula = yards_gained ~ ., data = train)
## Deviance Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.394  -4.360  -0.807   3.077  50.198 
## 
## (Dispersion Parameter for gaussian family taken to be 55.5335)
## 
##     Null Deviance: 92558.8 on 1412 degrees of freedom
## Residual Deviance: 76913.94 on 1385 degrees of freedom
## AIC: 9715.642 
## 
## Number of Local Scoring Iterations: 2 
## 
## Anova for Parametric Effects
##                       Df Sum Sq Mean Sq F value    Pr(>F)    
## hangTime               1    122   121.8  2.1932 0.1388487    
## punt_position_x        1     19    19.3  0.3474 0.5556952    
## punt_position_y        1     16    15.5  0.2792 0.5973293    
## field_position_x       1     27    27.0  0.4868 0.4854726    
## field_position_y       1     16    16.2  0.2921 0.5889466    
## receiving_player_1     1      0     0.4  0.0067 0.9348098    
## receiving_player_2     1   5381  5380.9 96.8943 < 2.2e-16 ***
## receiving_player_3     1     85    85.2  1.5336 0.2157799    
## receiving_player_4     1    265   265.0  4.7712 0.0291067 *  
## receiving_player_5     1    709   709.2 12.7708 0.0003641 ***
## receiving_player_6     1      0     0.1  0.0014 0.9697304    
## receiving_player_7     1    352   351.6  6.3315 0.0119734 *  
## receiving_player_8     1     41    40.9  0.7371 0.3907245    
## receiving_player_9     1     83    83.2  1.4973 0.2212878    
## receiving_player_10    1     91    90.9  1.6375 0.2008828    
## receiving_player_11    1      3     2.7  0.0491 0.8247168    
## punting_player_1       1   3229  3228.7 58.1388 4.513e-14 ***
## punting_player_2       1   3074  3073.7 55.3485 1.764e-13 ***
## punting_player_3       1    814   814.3 14.6633 0.0001343 ***
## punting_player_4       1    114   113.9  2.0508 0.1523529    
## punting_player_5       1     51    50.9  0.9160 0.3387055    
## punting_player_6       1     84    84.4  1.5206 0.2177350    
## punting_player_7       1    174   174.1  3.1344 0.0768760 .  
## punting_player_8       1    310   309.8  5.5785 0.0183197 *  
## punting_player_9       1    371   370.6  6.6726 0.0098922 ** 
## punting_player_10      1    115   115.3  2.0771 0.1497486    
## punting_player_11      1     99    99.4  1.7890 0.1812642    
## Residuals           1385  76914    55.5                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(gamMod, test)}

\NormalTok{predTable }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\AttributeTok{actuals=}\NormalTok{test}\SpecialCharTok{$}\NormalTok{yards\_gained, }\AttributeTok{predicted=}\NormalTok{pred))}

\FunctionTok{ggplot}\NormalTok{(predTable, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ actuals, }\AttributeTok{y =}\NormalTok{ predicted)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=}\StringTok{\textquotesingle{}gam\textquotesingle{}}\NormalTok{, }\AttributeTok{formula =}\NormalTok{ y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x) }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{splineMod }\OtherTok{=} \FunctionTok{gam}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}} \FunctionTok{ns}\NormalTok{(hangTime, }\AttributeTok{df=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punt\_position\_x, }\AttributeTok{df=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punt\_position\_y, }\AttributeTok{df=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(field\_position\_x, }\AttributeTok{df=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(field\_position\_y, }\AttributeTok{df=}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_1, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_2, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_3, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_4, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_5, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_6, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_7, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_8, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_1, }\AttributeTok{df=}\DecValTok{9}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_10, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(receiving\_player\_11, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_1, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_2, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_3, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_4, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_5, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_6, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_7, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_8, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_10, }\AttributeTok{df=}\DecValTok{6}\NormalTok{)}\SpecialCharTok{+} \FunctionTok{ns}\NormalTok{(punting\_player\_11, }\AttributeTok{df=}\DecValTok{6}\NormalTok{), }\AttributeTok{data=}\NormalTok{train)}

\NormalTok{splinePred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(splineMod, test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :
## prediction from a rank-deficient fit may be misleading
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{splineMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((splinePred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Trees}
\NormalTok{treeModel }\OtherTok{\textless{}{-}} \FunctionTok{tree}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ train)}
\FunctionTok{summary}\NormalTok{(treeModel)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Regression tree:
## tree(formula = yards_gained ~ ., data = train)
## Variables actually used in tree construction:
## [1] "punting_player_2"   "punting_player_1"   "receiving_player_8"
## [4] "punting_player_9"   "punting_player_7"  
## Number of terminal nodes:  8 
## Residual mean deviance:  54.86 = 77080 / 1405 
## Distribution of residuals:
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -19.6400  -4.4940  -0.9337   0.0000   3.3220  50.5600
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(treeModel)}
\FunctionTok{text}\NormalTok{(treeModel)}
\end{Highlighting}
\end{Shaded}

\includegraphics{testModels_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(treeModel, test)}
\NormalTok{treeMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Random Forest}
\NormalTok{forestMod }\OtherTok{\textless{}{-}} \FunctionTok{randomForest}\NormalTok{(}\AttributeTok{x =}\NormalTok{ xtrain, }\AttributeTok{y =}\NormalTok{ ytrain, }\AttributeTok{data =}\NormalTok{ train, }\AttributeTok{importance =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{ntree =} \DecValTok{1000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in rfout$mse/(var(y) * (n - 1)/n): Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{forestMod}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
##  randomForest(x = xtrain, y = ytrain, ntree = 1000, importance = TRUE,      data = train) 
##                Type of random forest: regression
##                      Number of trees: 1000
## No. of variables tried at each split: 9
## 
##           Mean of squared residuals: 56.82858
##                     % Var explained: 13.25
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(forestMod, test)}
\NormalTok{forestMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pred }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# SVM}
\NormalTok{svmMod }\OtherTok{\textless{}{-}} \FunctionTok{svm}\NormalTok{(yards\_gained }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train)}
\NormalTok{predSVM }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(svmMod, test)}

\NormalTok{svmMSE }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((predSVM }\SpecialCharTok{{-}}\NormalTok{ test}\SpecialCharTok{$}\NormalTok{yards\_gained)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Analysis}
\NormalTok{mseTable }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(}\StringTok{"Linear"}\OtherTok{=}\NormalTok{lmMSE, }\StringTok{"Logit"}\OtherTok{=}\NormalTok{logitMSE, }\StringTok{"Lasso"}\OtherTok{=}\NormalTok{lassoMSE, }\StringTok{"Ridge"}\OtherTok{=}\NormalTok{ridgeMSE, }\StringTok{"GAM"}\OtherTok{=}\NormalTok{gamMSE, }\StringTok{"SVM"}\OtherTok{=}\NormalTok{svmMSE, }\StringTok{"Spline"}\OtherTok{=}\NormalTok{splineMSE))}
\FunctionTok{print}\NormalTok{(mseTable)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Linear    Logit    Lasso    Ridge      GAM      SVM   Spline
## 1 114.6148 114.6148 114.0505 113.7368 114.6148 118.7356 120.9357
\end{verbatim}

\end{document}
